(()=>{"use strict";$(document).ready((function(){function e(){return $('meta[name="csrf-token"]').attr("content")}function n(e){e&&("admin"===e?window.location.href="/management-admin":"agriculturist"===e&&(window.location.href="/management-agriculturist"))}$("#loginForm").on("submit",(function(a){a.preventDefault(),$.ajax({url:"/api/login",type:"POST",data:{username:$("#username").val(),password:$("#password").val()},headers:{"X-CSRF-TOKEN":e()},success:function(e){e.user?n(e.user.role):$("#loginResult").html('<div class="alert alert-danger">Login failed!</div>')},error:function(e){var n=e.responseJSON?e.responseJSON.message:"Login failed!";$("#loginResult").html('<div class="alert alert-danger">'+n+"</div>")}})})),$.ajax({url:"/api/csrf-cookie",type:"GET",xhrFields:{withCredentials:!0}}).done((function(){$.ajax({url:"/api/check-user",type:"GET",xhrFields:{withCredentials:!0},headers:{"X-CSRF-TOKEN":e()}}).done((function(e){if("Invalid Token"!==e.message){var a=e.user.role;a?n(a):console.log("No cookie session found.")}}))}))}))})();